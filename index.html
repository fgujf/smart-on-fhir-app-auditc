<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Alcohol Assessment - AUDIT C (SMART-enabled)</title>
  <style>
    body { font-family: Arial, sans-serif; margin:20px; }
    .section { padding:15px; margin-bottom:10px; border-radius:5px; }
    .section-1 { background-color:#e6f7ff; }
    .section-2 { background-color:#fffbe6; }
    label { display:block; margin-top:10px; font-weight:bold; }
    select { width:100%; padding:5px; margin-top:5px; }
    .result, .score-output { margin-top:10px; font-weight:bold; }
    .risk-low { background:#e6f9ed; color:#28a745; padding:5px 10px; border-radius:4px; }
    .risk-increasing { background:#fff9db; color:#ffc107; padding:5px 10px; border-radius:4px; }
    .risk-higher { background:#fff3e0; color:#ff9800; padding:5px 10px; border-radius:4px; }
    .risk-dependence { background:#fdecea; color:#dc3545; padding:5px 10px; border-radius:4px; }
    button { margin-top:10px; padding:8px 12px; }
    .disabled-section { opacity:0.6; pointer-events:none; }
    .small-select { width:200px; padding:5px; margin-top:5px; }
  </style>
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/fhirclient/build/fhir-client.js"></script>
<script src="app.js"></script>

<div id="contextBanner" style="background:#f0f0f0;padding:8px;margin-bottom:15px;border-radius:5px;">
  Loading patient and provider info...
</div>

<h1>Alcohol Assessment – AUDIT C</h1>

<form id="auditForm">
  <label>
    Gender: *
    <select id="gender" class="small-select" required>
      <option value="" disabled selected>Choose...</option>
      <option value="male">Male</option>
      <option value="female">Female</option>
      <option value="other">Other / Prefer not to say</option>
    </select>
  </label>

  <div class="section section-1">
    <h2>Section 1 (Questions 1–3)</h2>
    <label>
      1. How often do you have a drink containing alcohol? *
      <select id="q1" required>
        <option value="" disabled selected>Choose...</option>
        <option value="0">Never (0)</option>
        <option value="1">Monthly or less (1)</option>
        <option value="2">2–4 times per month (2)</option>
        <option value="3">2–3 times per week (3)</option>
        <option value="4">4 or more times per week (4)</option>
      </select>
    </label>
    <label>
      2. How many units do you drink on a typical drinking day? *
      <select id="q2" required>
        <option value="" disabled selected>Choose...</option>
        <option value="0">0–2 units (0)</option>
        <option value="1">3–4 units (1)</option>
        <option value="2">5–6 units (2)</option>
        <option value="3">7–9 units (3)</option>
        <option value="4">10 or more units (4)</option>
      </select>
    </label>
    <label>
      3. How often have you had 6+ (F) / 8+ (M) units on one occasion in the past year? *
      <select id="q3" required>
        <option value="" disabled selected>Choose...</option>
        <option value="0">Never (0)</option>
        <option value="1">Less than monthly (1)</option>
        <option value="2">Monthly (2)</option>
        <option value="3">Weekly (3)</option>
        <option value="4">Daily or almost daily (4)</option>
      </select>
    </label>

    <button type="button" onclick="calculateFastC()">Calculate FAST C Score</button>
    <div id="fastCScore" class="score-output">FAST C Score: —</div>
  </div>

  <div id="section2" class="section section-2 disabled-section">
    <h2>Section 2 (Questions 4–10)</h2>
      <!-- (all your section 2 select elements are preserved exactly) -->
      <label>
        4. How often during the last year have you found you couldn’t stop drinking once started? *
        <select id="q4" required>
          <option value="" disabled selected>Choose...</option>
          <option value="0">Never (0)</option>
          <option value="1">Less than monthly (1)</option>
          <option value="2">Monthly (2)</option>
          <option value="3">Weekly (3)</option>
          <option value="4">Daily or almost daily (4)</option>
        </select>
      </label>
      <label>
        5. How often in the last year did drinking prevent doing what was expected? *
        <select id="q5" required>
          <option value="" disabled selected>Choose...</option>
          <option value="0">Never (0)</option>
          <option value="1">Less than monthly (1)</option>
          <option value="2">Monthly (2)</option>
          <option value="3">Weekly (3)</option>
          <option value="4">Daily or almost daily (4)</option>
        </select>
      </label>
      <label>
        6. How often in the last year did you need a drink in the morning after heavy drinking? *
        <select id="q6" required>
          <option value="" disabled selected>Choose...</option>
          <option value="0">Never (0)</option>
          <option value="1">Less than monthly (1)</option>
          <option value="2">Monthly (2)</option>
          <option value="3">Weekly (3)</option>
          <option value="4">Daily or almost daily (4)</option>
        </select>
      </label>
      <label>
        7. How often in the last year have you felt guilt or remorse after drinking? *
        <select id="q7" required>
          <option value="" disabled selected>Choose...</option>
          <option value="0">Never (0)</option>
          <option value="1">Less than monthly (1)</option>
          <option value="2">Monthly (2)</option>
          <option value="3">Weekly (3)</option>
          <option value="4">Daily or almost daily (4)</option>
        </select>
      </label>
      <label>
        8. How often in the last year were you unable to remember what happened the night before? *
        <select id="q8" required>
          <option value="" disabled selected>Choose...</option>
          <option value="0">Never (0)</option>
          <option value="1">Less than monthly (1)</option>
          <option value="2">Monthly (2)</option>
          <option value="3">Weekly (3)</option>
          <option value="4">Daily or almost daily (4)</option>
        </select>
      </label>
      <label>
        9. Have you or someone else been injured due to your drinking? *
        <select id="q9" required>
          <option value="" disabled selected>Choose...</option>
          <option value="0">No (0)</option>
          <option value="2">Yes, but not in last year (2)</option>
          <option value="4">Yes, during the last year (4)</option>
        </select>
      </label>
      <label>
        10. Has a relative, friend, doctor, or health worker been concerned or suggested you cut down? *
        <select id="q10" required>
          <option value="" disabled selected>Choose...</option>
          <option value="0">No (0)</option>
          <option value="2">Yes, but not in last year (2)</option>
          <option value="4">Yes, during the last year (4)</option>
        </select>
      </label>

      <button type="button" onclick="calculateAuditScore()">Calculate Total Audit Score</button>
    <div id="totalAuditScore" class="score-output">Total Audit Score: —</div>
    <div id="riskSeverity" class="result"></div>

    <button id="saveToEHRBtn" type="button" onclick="saveToEHR()" disabled>
      Save answers to EHR (QuestionnaireResponse)
    </button>
  </div>
</form>

</body>
</html>



